[platformio]
src_dir = .

[env:esp32dev]
platform = espressif32@6.9.0  ; Pin to v6.x for Arduino ESP32 v2.x APIs
board = esp32dev
framework = arduino

; Serial configuration (for initial USB flash)
monitor_speed = 115200
upload_speed = 921600
upload_port = /dev/ttyACM0
monitor_port = /dev/ttyACM0

; OTA configuration (uncomment after first flash)
; For OTA updates, comment out upload_port above and uncomment these:
; upload_protocol = espota
; upload_port = tombo-ugv-beast.local  ; Or use IP address: 192.168.x.x
; upload_flags = 
;     --auth=tombo-ota-2025  ; Change this password!

; Partition scheme for OTA (dual app partitions)
board_build.partitions = min_spiffs.csv  ; Use minimal SPIFFS with OTA partitions

; Build flags
build_flags = 
    -D ARDUINO_USB_CDC_ON_BOOT=0
    -D ARDUINO_USB_MODE=0
    -D ICM_20948_USE_DMP  ; Enable DMP (Digital Motion Processor) for 9-axis IMU fusion
    -Wno-error=return-type  ; Allow warnings for missing return statements (Waveshare code)

; Library dependencies
lib_deps = 
    adafruit/Adafruit SSD1306@^2.5.7
    adafruit/Adafruit GFX Library@^1.11.3
    adafruit/Adafruit BusIO@^1.14.1
    wollewald/INA219_WE@^1.3.4
    bblanchon/ArduinoJson@^6.21.3
    electroniccats/mpu6050@^1.3.0
    bodmer/TFT_eSPI@^2.5.0
    workloads/SCServo@^1.0.1
    madhephaestus/ESP32Encoder@^0.11.8
    sparkfun/SparkFun 9DoF IMU Breakout - ICM 20948 - Arduino Library@^1.3.2
    https://github.com/gelraen/Arduino-PID-Library.git
    denyssene/SimpleKalmanFilter@^0.1.0
